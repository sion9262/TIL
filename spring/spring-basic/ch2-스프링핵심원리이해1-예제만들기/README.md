# ch2 스프링 핵심 원리 이해 1 - 예제 만들기

## 개발 환경

Project: Gradle Project
Spring Boot: 2.5.5
Language: Java
Packaging: Jar
Java: 11

Project Metadata
- groupId: sion
- artifactId: basic

IDE : Intellij

## 비즈니스 요구사항과 설계
- 회원
    - 회원을 가입하고 조회할 수 있다.
    - 회원은 일반과 VIP 두 가지 등급이 있다.
    - 회원 데이터는 자체 DB를 구축할 수 있고, 외부 시스템과 연동할 수 있다. (미확정)
- 주문과 할인 정책
    - 회원은 상품을 주문할 수 있다.
    - 회원 등급에 따라 할인 정책을 적용할 수 있다.
    - 할인 정책은 모든 VIP는 1000원을 할인해주는 고정 금액 할인을 적용해달라. (나중에 변경 될 수 있다.)
    - 할인 정책은 변경 가능성이 높다. 회사의 기본 할인 정책을 아직 정하지 못했고, 오픈 직전까지 고민을
    미루고 싶다. 최악의 경우 할인을 적용하지 않을 수 도 있다. (미확정)

## 회원 도메인 설계
- 회원
    - 회원을 가입하고 조회할 수 있다.
    - 회원은 일반과 VIP 두 가지 등급이 있다.
    - 회원 데이터는 자체 DB를 구축할 수 있고, 외부 시스템과 연동할 수 있다. (미확정)

회원 도메인 협력 관계

회원 클래스 다이어그램

회원 객체 다이어그램 

... 생략

## 회원 도메인 개발 - 공부 한 내용

1. Enum
    - 열거 타입 등장 자바 1.5부터 ~
    - 기존 static final로 불변의 상수값을 만들었음.
    - static final 문제
        - 타입 안전을 보장할 수 없음.
        - 다른 값을 넣었을 때 컴파일이 걸러내지 못함.
    - 이를 해결하기 위해 Enum 생겨남
    - 상수들의 타입을 정의, 정의한 타입외의 타입이 들어오면 컴파일 체크
    - 단 메모리에 올리고 초기화 하는 공간/시간적 비용에 약간의 손해봄.

2. interface

MemberRepository로 선언하면 MemoryMemberRepository에 다른 메소드가 있어도 MemberRepository 메소드만 사용 가능 참조 변수

```java
private final MemberRepository memberRepository = new MemoryMemberRepository();
```

## 주문과 할인 도메인 설계
- 주문과 할인 정책
    - 회원은 상품을 주문할 수 있다.
    - 회원 등급에 따라 할인 정책을 적용할 수 있다.
    - 할인 정책은 모든 VIP는 1000원을 할인해주는 고정 금액 할인을 적용해달라. (나중에 변경 될 수
    있다.)
    - 할인 정책은 변경 가능성이 높다. 회사의 기본 할인 정책을 아직 정하지 못했고, 오픈 직전까지 고민을
    미루고 싶다. 최악의 경우 할인을 적용하지 않을 수 도 있다. (미확정)

1. 주문 생성: 클라이언트는 주문 서비스에 주문 생성을 요청한다.  
2. 회원 조회: 할인을 위해서는 회원 등급이 필요하다. 그래서 주문 서비스는 회원 저장소에서 회원을
조회한다.  
3. 할인 적용: 주문 서비스는 회원 등급에 따른 할인 여부를 할인 정책에 위임한다.  
4. 주문 결과 반환: 주문 서비스는 할인 결과를 포함한 주문 결과를 반환한다.

